define ("tool_lp/user_competency_plan_popup",["jquery","core/notification","core/str","core/ajax","core/templates","tool_lp/dialogue","core/pending"],function(a,b,c,d,e,f,g){var h=function(b,c,d){this._regionSelector=b;this._userCompetencySelector=c;this._planId=d;a(this._regionSelector).on("click",this._userCompetencySelector,this._handleClick.bind(this))};h.prototype._handleClick=function(c){c.preventDefault();var e=a(c.target).closest("tr"),f=a(e).data("competencyid"),g=a(e).data("userid"),h=this._planId,i=d.call([{methodname:"tool_lp_data_for_user_competency_summary_in_plan",args:{competencyid:f,planid:h},done:this._contextLoaded.bind(this),fail:b.exception}]);i[0].then(function(a){var b="core_competency_user_competency_viewed_in_plan";if(a.plan.iscompleted){b="core_competency_user_competency_plan_viewed"}return d.call([{methodname:b,args:{competencyid:f,userid:g,planid:h}}])[0]}).catch(b.exception)};h.prototype._contextLoaded=function(a){var d=this,h=new g("tool_lp/user_competency_plan_popup:_contextLoaded");e.render("tool_lp/user_competency_summary_in_plan",a).then(function(a,g){return c.get_string("usercompetencysummary","report_competency").then(function(b){return new f(b,a,e.runTemplateJS.bind(e,g),d._refresh.bind(d),!0)}).then(h.resolve).catch(b.exception)}).catch(b.exception)};h.prototype._refresh=function(){var a=this._planId;d.call([{methodname:"tool_lp_data_for_plan_page",args:{planid:a},done:this._pageContextLoaded.bind(this),fail:b.exception}])};h.prototype._pageContextLoaded=function(a){var c=this;e.render("tool_lp/plan_page",a).done(function(a,b){e.replaceNode(c._regionSelector,a,b)}).fail(b.exception)};h.prototype._regionSelector=null;h.prototype._userCompetencySelector=null;h.prototype._planId=null;return h});
//# sourceMappingURL=user_competency_plan_popup.min.js.map
