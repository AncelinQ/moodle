define(["jquery","core/form-autocomplete","core/str","core/notification","core/pending"],function(a,b,c,d,e){var f={UNIFIED_FILTERS:"#unified-filters"},g=function(){var g=[{key:"userfilterplaceholder",component:"moodle"},{key:"nofiltersapplied",component:"moodle"}];M.util.js_pending("unified_filter_datasource"),c.get_strings(g).done(function(a){var c=a[0],d=a[1];return b.enhance(f.UNIFIED_FILTERS,!0,"core_user/unified_filter_datasource",c,!1,!0,d,!0)}).then(function(){M.util.js_complete("unified_filter_datasource")}).fail(d.exception);var h=a(f.UNIFIED_FILTERS).val();a(f.UNIFIED_FILTERS).on("change",function(){var b=new e("core/unified_filter:change"),c=a(this).val(),d=[],f=[],g=!1;if(a.each(c,function(a,b){var c=b.split(":",2);if(2!==c.length)return f.push(b),!0;var e=c[0],h=c[1];return"undefined"!=typeof d[e]&&(g=!0),d[e]=h,!0}),g){var i=[];for(var j in d)i.push(j+":"+d[j]);i=i.concat(f),a(this).val(i)}h.join(",")!=c.join(",")&&this.form.submit(),b.resolve()})},h=function(){return a(f.UNIFIED_FILTERS).closest("form")};return{init:function(){g()},getForm:function(){return h()}}});