define(["jquery","core/form-autocomplete","core/str","core/notification","core/pending"],function(a,b,c,d,e){var f={UNIFIED_FILTERS:"#unified-filters"},g=function(){var g=[{key:"userfilterplaceholder",component:"moodle"},{key:"nofiltersapplied",component:"moodle"}];M.util.js_pending("unified_filter_datasource"),c.get_strings(g).done(function(a){var c=a[0],e=a[1];b.enhance(f.UNIFIED_FILTERS,!0,"core_user/unified_filter_datasource",c,!1,!0,e,!0).then(function(){M.util.js_complete("unified_filter_datasource")}).fail(d.exception)}).fail(d.exception);var h=a(f.UNIFIED_FILTERS).val();a(f.UNIFIED_FILTERS).on("change",function(){var b=a(this).val(),c=[],d=[],f=!1;if(a.each(b,function(a,b){var e=b.split(":",2);if(2!==e.length)return d.push(b),!0;var g=e[0],h=e[1];return"undefined"!=typeof c[g]&&(f=!0),c[g]=h,!0}),f){var g=[];for(var i in c)g.push(i+":"+c[i]);g=g.concat(d),a(this).val(g)}h.join(",")!=b.join(",")&&(new e("core_user/unified_filter:submit"),this.form.submit())})},h=function(){return a(f.UNIFIED_FILTERS).closest("form")};return{init:function(){g()},getForm:function(){return h()}}});