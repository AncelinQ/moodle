YUI.add("moodle-atto_media-button",function(e,t){var n="atto_media",r='<form class="atto_form"><label for="atto_media_urlentry">{{get_string "enterurl" component}}</label><input class="fullwidth" type="url" id="atto_media_urlentry" size="32"/><br/><button id="openmediabrowser" type="button">{{get_string "browserepositories" component}}</button><label for="atto_media_nameentry">{{get_string "entername" component}}</label><input class="fullwidth" type="text" id="atto_media_nameentry" size="32" required="true"/><div class="mdl-align"><br/><button id="atto_media_urlentrysubmit" type="submit">{{get_string "createmedia" component}}</button></div></form>';e.namespace("M.atto_media").Button=e.Base.create("button",e.M.editor_atto.EditorPlugin,[],{_currentSelection:null,initializer:function(){this.addButton({icon:"e/insert_edit_video",callback:this.chooseMedia})},chooseMedia:function(){this._currentSelection=this.get("host").getSelection();if(this._currentSelection===!1)return;var e=this.getDialogue({headerContent:M.util.get_string("createmedia",n)});e.set("bodyContent",this._getDialogueContent()).show()},_getDialogueContent:function(){var t=e.Handlebars.compile(r),i=e.Node.create(t({component:n}));return i.one("#atto_media_urlentrysubmit").on("click",this.setMedia,this),i.one("#openmediabrowser").on("click",function(e){e.preventDefault(),this.get("host").showFilepicker("media",this._filepickerCallback,this)},this),i},_filepickerCallback:function(t){t.url!==""&&(e.one("#atto_media_urlentry").set("value",t.url),e.one("#atto_media_nameentry").set("value",t.file))},setMedia:function(t){t.preventDefault(),this.getDialogue().hide();var n=t.currentTarget.ancestor(".atto_form"),r=n.one("#atto_media_urlentry").get("value"),i=n.one("#atto_media_nameentry").get("value"),s=this.get("host");if(r!==""&&i!==""){s.setSelection(this._currentSelection);var o='<a href="'+e.Escape.html(r)+'">'+i+"</a>";s.insertContentAtFocusPoint(o),this.markUpdated()}}})},"@VERSION@",{requires:["moodle-editor_atto-plugin"]});
