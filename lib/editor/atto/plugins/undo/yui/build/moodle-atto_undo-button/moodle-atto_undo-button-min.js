YUI.add("moodle-atto_undo-button",function(e,t){e.namespace("M.atto_undo").Button=e.Base.create("button",e.M.editor_atto.EditorPlugin,[],{_maxUndos:40,_undoStack:[],_redoStack:[],undoHandler:function(){var e=this.editor.getHTML();this._redoStack.push(e);var t=this._undoStack.pop();t===e&&(t=this._undoStack.pop()),t&&(this.editor.setHTML(t),this._undoStack.push(t),this.highlightButton("redo"))},redoHandler:function(e){e.preventDefault();var t=this.editor.getHTML();this._undoStack.push(t);var n=this._redoStack.pop();this.editor.setHTML(n),this._undoStack.push(n)},changeListener:function(e){if(e.event.type.indexOf("key")!==-1&&e.event.keyCode!==39&&e.event.keyCode!==37&&e.event.keyCode!==40&&e.event.keyCode!==38)return;typeof this._undoStack=="undefined"&&(this._undoStack=[]);var t=this._undoStack[this._undoStack.length-1],n=this.editor.getHTML();t!==n&&(this._undoStack.push(editable.getHTML()),this._redoStack=[],this.unHighlightButton("redo"));while(this._undoStack.length>this._maxUndos)this._undoStack.shift();this._undoStack.length?this.highlightButton("undo"):this.unHighlightButton("undo")},initializer:function(){this.addButton({icon:"e/undo",callback:this.undoHandler,buttonName:"undo",keys:90}),this.addButton({icon:"e/redo",callback:this.redoHandler,buttonName:"redo",keys:89}),this.get("host").on("atto:selectionchanged",this.changeListener)}})},"@VERSION@",{requires:["moodle-editor_atto-plugin"]});
