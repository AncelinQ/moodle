YUI.add("moodle-core-aria-menubar",function(e,t){var n="moodle-core-aria-menubar",r={MENUBAR:'[role="menubar"]',MENUITEM:'[role="menuitem"]',MENU:'[role="menu"]',MENUBARITEMS:['[role="menubar"] > [role="menuitem"]','[role="menubar"] > [role="presentation"] > [role="menuitem"]','[role="menubar"] *:not([role="menu"]) [role="menuitem"]'],MENUBARITEMWITHCHILD:['[role="menubar"][aria-haspopup="true"]'],MENUITEMS:['[role="menuitem"]']},i={LEFT:37,UP:38,RIGHT:39,DOWN:40,ENTER:13,SPACE:32,TAB:9};e.namespace("Moodle.core.aria").MenuBar=e.Base.create("MenuBar",e.Base,[],{_scopeNode:null,_events:[],initializer:function(){return this._scopeNode=e.one(this.get("scope")),this._scopeNode&&this._setupListeners(),this},destructor:function(){return e.EventHandle(this._events).detach(),this},_setupListeners:function(){return this._events.push(this._scopeNode.delegate("key",this._handleOpenMenuWithChild,"down:"+[i.ENTER,i.SPACE,i.UP,i.DOWN].join(", "),r.MENUBARITEMWITHCHILD.join(", "),this)),this._events.push(this._scopeNode.delegate("key",this._handleMenuBarItemLeftRight,"down:"+[i.LEFT,i.RIGHT].join(", "),r.MENUBARITEMS.join(", "),this)),this._events.push(this._scopeNode.delegate("key",this._handleMenuItemSelection,"down:"+[i.ENTER,i.SPACE].join(", "),r.MENUITEMS.join(", "),this)),this._events.push(this._scopeNode.delegate("key",this._handleMenuItemMovement,"down:"+[i.UP,i.DOWN].join(", "),r.MENUITEMS.join(", "),this)),this},_handleMenuBarItemLeftRight:function(e){if(!e.currentTarget.ancestor(r.MENUITEM,!0))return this;if(e.currentTarget.ancestor(r.MENU))return this;var t=e.currentTarget.ancestor(r.MENUBAR),n;return e.keyCode===i.LEFT?n=this._getMenuItem(t,e.currentTarget,!0):e.keyCode===i.RIGHT&&(n=this._getMenuItem(t,e.currentTarget)),n&&(this._selectNode(n,e.currentTarget),e.preventDefault()),this},_handleOpenMenuWithChild:function(e){var t=e.currentTarget.ancestor(r.MENUITEM,!0);if(!t)return this;if(!t.hasAttribute("aria-owns"))return this},_handleMenuItemSelection:function(e){return e.preventDefault(),e.currentTarget.simulate("click"),this},_handleMenuItemMovement:function(e){if(!e.currentTarget.ancestor(r.MENUITEM,!0))return this;var t=e.currentTarget.ancestor(r.MENU,!0),n;return t?(e.keyCode===i.UP?n=this._getMenuItem(t,e.currentTarget,!0,!0):e.keyCode===i.DOWN&&(n=this._getMenuItem(t,e.currentTarget,!1,!0)),n&&(this._selectNode(n,e.currentTarget),e.preventDefault()),this):this},_getMenuItem:function(e,t,n,i){var s=e.all(r.MENUITEM),o=s.size(),u;n=n||!1,i=i||!1;if(o===1)return null;if(o===2)return s.item(0)===t&&!n?u=s.item(1):s.item(1)===t&&n&&(u=s.item(0)),u&&u.hasAttribute("hidden")&&(u=null),u;if(o>2){var a=0,f=1,l=0;for(a=0;a<o;a++)if(s.item(a)===t)break;if(s.item(a)!==t)return null;n&&(f=-1);do a+=f,i&&(a<0?a=o-1:a>=o&&(a=0)),u=s.item(a),l++;while(u&&l<o&&u!==t&&u.hasClass("hidden"))}return u},_selectNode:function(e){return e.focus(),this}},{ATTRS:{scope:{value:null,writeOnce:!0}}}),arntemp=function(){return new e.Moodle.core.aria.MenuBar({scope:"#page"})}},"@VERSION@",{requires:["base","event","event-key","node"]});
