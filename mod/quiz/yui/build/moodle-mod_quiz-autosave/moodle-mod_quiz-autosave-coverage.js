if (typeof __coverage__ === 'undefined') { __coverage__ = {}; }
if (!__coverage__['mod/quiz/yui/build/moodle-mod_quiz-autosave/moodle-mod_quiz-autosave.js']) {
   __coverage__['mod/quiz/yui/build/moodle-mod_quiz-autosave/moodle-mod_quiz-autosave.js'] = {"path":"mod/quiz/yui/build/moodle-mod_quiz-autosave/moodle-mod_quiz-autosave.js","s":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0,0],"19":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0},"fnMap":{"1":{"name":"(anonymous_1)","line":1,"loc":{"start":{"line":1,"column":36},"end":{"line":1,"column":55}}},"2":{"name":"(anonymous_2)","line":70,"loc":{"start":{"line":70,"column":10},"end":{"line":70,"column":26}}},"3":{"name":"(anonymous_3)","line":88,"loc":{"start":{"line":88,"column":30},"end":{"line":88,"column":41}}},"4":{"name":"(anonymous_4)","line":89,"loc":{"start":{"line":89,"column":57},"end":{"line":89,"column":74}}},"5":{"name":"(anonymous_5)","line":98,"loc":{"start":{"line":98,"column":25},"end":{"line":98,"column":36}}},"6":{"name":"(anonymous_6)","line":103,"loc":{"start":{"line":103,"column":33},"end":{"line":103,"column":44}}},"7":{"name":"(anonymous_7)","line":104,"loc":{"start":{"line":104,"column":57},"end":{"line":104,"column":74}}},"8":{"name":"(anonymous_8)","line":122,"loc":{"start":{"line":122,"column":18},"end":{"line":122,"column":40}}},"9":{"name":"(anonymous_9)","line":140,"loc":{"start":{"line":140,"column":25},"end":{"line":140,"column":51}}},"10":{"name":"(anonymous_10)","line":147,"loc":{"start":{"line":147,"column":19},"end":{"line":147,"column":31}}},"11":{"name":"(anonymous_11)","line":155,"loc":{"start":{"line":155,"column":20},"end":{"line":155,"column":37}}},"12":{"name":"(anonymous_12)","line":159,"loc":{"start":{"line":159,"column":35},"end":{"line":159,"column":46}}},"13":{"name":"(anonymous_13)","line":170,"loc":{"start":{"line":170,"column":22},"end":{"line":170,"column":33}}},"14":{"name":"(anonymous_14)","line":175,"loc":{"start":{"line":175,"column":18},"end":{"line":175,"column":29}}},"15":{"name":"(anonymous_15)","line":182,"loc":{"start":{"line":182,"column":18},"end":{"line":182,"column":29}}},"16":{"name":"(anonymous_16)","line":202,"loc":{"start":{"line":202,"column":15},"end":{"line":202,"column":26}}},"17":{"name":"(anonymous_17)","line":210,"loc":{"start":{"line":210,"column":25},"end":{"line":210,"column":36}}},"18":{"name":"(anonymous_18)","line":215,"loc":{"start":{"line":215,"column":21},"end":{"line":215,"column":32}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":225,"column":112}},"2":{"start":{"line":27,"column":0},"end":{"line":27,"column":30}},"3":{"start":{"line":28,"column":0},"end":{"line":222,"column":2}},"4":{"start":{"line":71,"column":8},"end":{"line":71,"column":52}},"5":{"start":{"line":72,"column":8},"end":{"line":74,"column":9}},"6":{"start":{"line":73,"column":12},"end":{"line":73,"column":19}},"7":{"start":{"line":76,"column":8},"end":{"line":76,"column":34}},"8":{"start":{"line":78,"column":8},"end":{"line":78,"column":106}},"9":{"start":{"line":79,"column":8},"end":{"line":79,"column":106}},"10":{"start":{"line":80,"column":8},"end":{"line":80,"column":59}},"11":{"start":{"line":82,"column":8},"end":{"line":82,"column":58}},"12":{"start":{"line":84,"column":8},"end":{"line":84,"column":40}},"13":{"start":{"line":85,"column":8},"end":{"line":85,"column":35}},"14":{"start":{"line":89,"column":8},"end":{"line":95,"column":17}},"15":{"start":{"line":90,"column":12},"end":{"line":90,"column":43}},"16":{"start":{"line":91,"column":12},"end":{"line":93,"column":13}},"17":{"start":{"line":92,"column":16},"end":{"line":92,"column":23}},"18":{"start":{"line":94,"column":12},"end":{"line":94,"column":65}},"19":{"start":{"line":99,"column":8},"end":{"line":99,"column":43}},"20":{"start":{"line":100,"column":8},"end":{"line":100,"column":73}},"21":{"start":{"line":104,"column":8},"end":{"line":114,"column":17}},"22":{"start":{"line":105,"column":12},"end":{"line":106,"column":44}},"23":{"start":{"line":107,"column":12},"end":{"line":109,"column":13}},"24":{"start":{"line":108,"column":16},"end":{"line":108,"column":23}},"25":{"start":{"line":110,"column":12},"end":{"line":113,"column":13}},"26":{"start":{"line":111,"column":16},"end":{"line":111,"column":55}},"27":{"start":{"line":112,"column":16},"end":{"line":112,"column":53}},"28":{"start":{"line":123,"column":8},"end":{"line":129,"column":9}},"29":{"start":{"line":124,"column":12},"end":{"line":127,"column":13}},"30":{"start":{"line":125,"column":16},"end":{"line":125,"column":98}},"31":{"start":{"line":128,"column":12},"end":{"line":128,"column":19}},"32":{"start":{"line":131,"column":8},"end":{"line":131,"column":71}},"33":{"start":{"line":132,"column":8},"end":{"line":132,"column":72}},"34":{"start":{"line":141,"column":8},"end":{"line":141,"column":56}},"35":{"start":{"line":142,"column":8},"end":{"line":142,"column":54}},"36":{"start":{"line":143,"column":8},"end":{"line":143,"column":54}},"37":{"start":{"line":144,"column":8},"end":{"line":144,"column":57}},"38":{"start":{"line":148,"column":8},"end":{"line":151,"column":9}},"39":{"start":{"line":150,"column":12},"end":{"line":150,"column":19}},"40":{"start":{"line":152,"column":8},"end":{"line":152,"column":45}},"41":{"start":{"line":156,"column":8},"end":{"line":156,"column":45}},"42":{"start":{"line":160,"column":8},"end":{"line":160,"column":26}},"43":{"start":{"line":162,"column":8},"end":{"line":165,"column":9}},"44":{"start":{"line":164,"column":12},"end":{"line":164,"column":19}},"45":{"start":{"line":167,"column":8},"end":{"line":167,"column":32}},"46":{"start":{"line":171,"column":8},"end":{"line":171,"column":28}},"47":{"start":{"line":172,"column":8},"end":{"line":172,"column":72}},"48":{"start":{"line":176,"column":8},"end":{"line":178,"column":9}},"49":{"start":{"line":177,"column":12},"end":{"line":177,"column":38}},"50":{"start":{"line":179,"column":8},"end":{"line":179,"column":32}},"51":{"start":{"line":183,"column":8},"end":{"line":183,"column":28}},"52":{"start":{"line":184,"column":8},"end":{"line":184,"column":27}},"53":{"start":{"line":186,"column":8},"end":{"line":189,"column":9}},"54":{"start":{"line":187,"column":12},"end":{"line":187,"column":35}},"55":{"start":{"line":188,"column":12},"end":{"line":188,"column":19}},"56":{"start":{"line":191,"column":8},"end":{"line":193,"column":9}},"57":{"start":{"line":192,"column":12},"end":{"line":192,"column":34}},"58":{"start":{"line":194,"column":8},"end":{"line":199,"column":11}},"59":{"start":{"line":203,"column":8},"end":{"line":203,"column":37}},"60":{"start":{"line":205,"column":8},"end":{"line":207,"column":9}},"61":{"start":{"line":206,"column":12},"end":{"line":206,"column":36}},"62":{"start":{"line":211,"column":8},"end":{"line":212,"column":81}},"63":{"start":{"line":216,"column":8},"end":{"line":216,"column":28}},"64":{"start":{"line":217,"column":8},"end":{"line":217,"column":32}},"65":{"start":{"line":218,"column":8},"end":{"line":220,"column":9}},"66":{"start":{"line":219,"column":12},"end":{"line":219,"column":42}}},"branchMap":{"1":{"line":27,"type":"binary-expr","locations":[{"start":{"line":27,"column":13},"end":{"line":27,"column":23}},{"start":{"line":27,"column":27},"end":{"line":27,"column":29}}]},"2":{"line":72,"type":"if","locations":[{"start":{"line":72,"column":8},"end":{"line":72,"column":8}},{"start":{"line":72,"column":8},"end":{"line":72,"column":8}}]},"3":{"line":91,"type":"if","locations":[{"start":{"line":91,"column":12},"end":{"line":91,"column":12}},{"start":{"line":91,"column":12},"end":{"line":91,"column":12}}]},"4":{"line":107,"type":"if","locations":[{"start":{"line":107,"column":12},"end":{"line":107,"column":12}},{"start":{"line":107,"column":12},"end":{"line":107,"column":12}}]},"5":{"line":110,"type":"if","locations":[{"start":{"line":110,"column":12},"end":{"line":110,"column":12}},{"start":{"line":110,"column":12},"end":{"line":110,"column":12}}]},"6":{"line":110,"type":"binary-expr","locations":[{"start":{"line":110,"column":16},"end":{"line":110,"column":51}},{"start":{"line":110,"column":55},"end":{"line":110,"column":95}}]},"7":{"line":123,"type":"if","locations":[{"start":{"line":123,"column":8},"end":{"line":123,"column":8}},{"start":{"line":123,"column":8},"end":{"line":123,"column":8}}]},"8":{"line":124,"type":"if","locations":[{"start":{"line":124,"column":12},"end":{"line":124,"column":12}},{"start":{"line":124,"column":12},"end":{"line":124,"column":12}}]},"9":{"line":148,"type":"if","locations":[{"start":{"line":148,"column":8},"end":{"line":148,"column":8}},{"start":{"line":148,"column":8},"end":{"line":148,"column":8}}]},"10":{"line":148,"type":"binary-expr","locations":[{"start":{"line":148,"column":12},"end":{"line":148,"column":47}},{"start":{"line":148,"column":51},"end":{"line":148,"column":87}},{"start":{"line":149,"column":16},"end":{"line":149,"column":56}}]},"11":{"line":162,"type":"if","locations":[{"start":{"line":162,"column":8},"end":{"line":162,"column":8}},{"start":{"line":162,"column":8},"end":{"line":162,"column":8}}]},"12":{"line":162,"type":"binary-expr","locations":[{"start":{"line":162,"column":12},"end":{"line":162,"column":28}},{"start":{"line":162,"column":32},"end":{"line":162,"column":53}}]},"13":{"line":176,"type":"if","locations":[{"start":{"line":176,"column":8},"end":{"line":176,"column":8}},{"start":{"line":176,"column":8},"end":{"line":176,"column":8}}]},"14":{"line":176,"type":"binary-expr","locations":[{"start":{"line":176,"column":12},"end":{"line":176,"column":28}},{"start":{"line":176,"column":32},"end":{"line":176,"column":57}}]},"15":{"line":186,"type":"if","locations":[{"start":{"line":186,"column":8},"end":{"line":186,"column":8}},{"start":{"line":186,"column":8},"end":{"line":186,"column":8}}]},"16":{"line":191,"type":"if","locations":[{"start":{"line":191,"column":8},"end":{"line":191,"column":8}},{"start":{"line":191,"column":8},"end":{"line":191,"column":8}}]},"17":{"line":205,"type":"if","locations":[{"start":{"line":205,"column":8},"end":{"line":205,"column":8}},{"start":{"line":205,"column":8},"end":{"line":205,"column":8}}]},"18":{"line":211,"type":"binary-expr","locations":[{"start":{"line":211,"column":15},"end":{"line":211,"column":31}},{"start":{"line":211,"column":35},"end":{"line":211,"column":59}},{"start":{"line":212,"column":16},"end":{"line":212,"column":80}}]},"19":{"line":218,"type":"if","locations":[{"start":{"line":218,"column":8},"end":{"line":218,"column":8}},{"start":{"line":218,"column":8},"end":{"line":218,"column":8}}]}},"code":["(function () { YUI.add('moodle-mod_quiz-autosave', function (Y, NAME) {","","// This file is part of Moodle - http://moodle.org/","//","// Moodle is free software: you can redistribute it and/or modify","// it under the terms of the GNU General Public License as published by","// the Free Software Foundation, either version 3 of the License, or","// (at your option) any later version.","//","// Moodle is distributed in the hope that it will be useful,","// but WITHOUT ANY WARRANTY; without even the implied warranty of","// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the","// GNU General Public License for more details.","//","// You should have received a copy of the GNU General Public License","// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.","","","/**"," * Auto-save functionality for during quiz attempts."," *"," * @package   mod_quiz"," * @copyright 1999 onwards Martin Dougiamas  {@link http://moodle.com}"," * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later"," */","","M.mod_quiz = M.mod_quiz || {};","M.mod_quiz.autosave = {","    /** Delays and repeat counts. */","    TINYMCE_DETECTION_DELAY:  500,","    TINYMCE_DETECTION_REPEATS: 20,","    WATCH_HIDDEN_DELAY:      1000,","","    /** Selectors. */","    SELECTORS: {","        QUIZ_FORM:             '#responseform',","        VALUE_CHANGE_ELEMENTS: 'input, textarea',","        CHANGE_ELEMENTS:       'input, select',","        HIDDEN_INPUTS:         'input[type=hidden]'","    },","","    /** Script that handles the auto-saves. */","    AUTOSAVE_HANDLER: M.cfg.wwwroot + '/mod/quiz/autosave.ajax.php',","","    /** The delay between a change being made, and it being auto-saved. */","    delay: 120000,","","    /** The form we are monitoring. */","    form: null,","","    /** Whether the form has been modified since the last save started. */","    dirty: false,","","    /** Timer object for the delay between form modifaction and the save starting. */","    delay_timer: null,","","    /** Y.io transaction for the save ajax request. */","    save_transaction: null,","","    /** Properly bound key change handler. */","    editor_change_handler: null,","","    hidden_field_values: {},","","    /**","     * Initialise the autosave code.","     * @param delay the delay, in seconds, between a change being detected, and","     * a save happening.","     */","    init: function(delay) {","        this.form = Y.one(this.SELECTORS.QUIZ_FORM);","        if (!this.form) {","            return;","        }","","        this.delay = delay * 1000;","","        this.form.delegate('valuechange', this.value_changed, this.SELECTORS.VALUE_CHANGE_ELEMENTS, this);","        this.form.delegate('change',      this.value_changed, this.SELECTORS.CHANGE_ELEMENTS,       this);","        this.form.on('submit', this.stop_autosaving, this);","","        this.init_tinymce(this.TINYMCE_DETECTION_REPEATS);","","        this.save_hidden_field_values();","        this.watch_hidden_fields();","    },","","    save_hidden_field_values: function() {","        this.form.all(this.SELECTORS.HIDDEN_INPUTS).each(function(hidden) {","            var name  = hidden.get('name');","            if (!name) {","                return;","            }","            this.hidden_field_values[name] = hidden.get('value');","        }, this);","    },","","    watch_hidden_fields: function() {","        this.detect_hidden_field_changes();","        Y.later(this.WATCH_HIDDEN_DELAY, this, this.watch_hidden_fields);","    },","","    detect_hidden_field_changes: function() {","        this.form.all(this.SELECTORS.HIDDEN_INPUTS).each(function(hidden) {","            var name  = hidden.get('name'),","                value = hidden.get('value');","            if (!name) {","                return;","            }","            if (!(name in this.hidden_field_values) || value !== this.hidden_field_values[name]) {","                this.hidden_field_values[name] = value;","                this.value_changed({target: hidden});","            }","        }, this);","    },","","    /**","     * @param repeatcount Because TinyMCE might load slowly, after us, we need","     * to keep trying every 10 seconds or so, until we detect TinyMCE is there,","     * or enough time has passed.","     */","    init_tinymce: function(repeatcount) {","        if (typeof tinyMCE === 'undefined') {","            if (repeatcount > 0) {","                Y.later(this.TINYMCE_DETECTION_DELAY, this, this.init_tinymce, [repeatcount - 1]);","            } else {","            }","            return;","        }","","        this.editor_change_handler = Y.bind(this.editor_changed, this);","        tinyMCE.onAddEditor.add(Y.bind(this.init_tinymce_editor, this));","    },","","    /**","     * @param repeatcount Because TinyMCE might load slowly, after us, we need","     * to keep trying every 10 seconds or so, until we detect TinyMCE is there,","     * or enough time has passed.","     */","    init_tinymce_editor: function(notused, editor) {","        editor.onChange.add(this.editor_change_handler);","        editor.onRedo.add(this.editor_change_handler);","        editor.onUndo.add(this.editor_change_handler);","        editor.onKeyDown.add(this.editor_change_handler);","    },","","    value_changed: function(e) {","        if (e.target.get('name') === 'thispage' || e.target.get('name') === 'scrollpos' ||","                e.target.get('name').match(/_:flagged$/)) {","            return; // Not interesting.","        }","        this.start_save_timer_if_necessary();","    },","","    editor_changed: function(editor) {","        this.start_save_timer_if_necessary();","    },","","    start_save_timer_if_necessary: function() {","        this.dirty = true;","","        if (this.delay_timer || this.save_transaction) {","            // Already counting down or daving.","            return;","        }","","        this.start_save_timer();","    },","","    start_save_timer: function() {","        this.cancel_delay();","        this.delay_timer = Y.later(this.delay, this, this.save_changes);","    },","","    cancel_delay: function() {","        if (this.delay_timer && this.delay_timer !== true) {","            this.delay_timer.cancel();","        }","        this.delay_timer = null;","    },","","    save_changes: function() {","        this.cancel_delay();","        this.dirty = false;","","        if (this.is_time_nearly_over()) {","            this.stop_autosaving();","            return;","        }","","        if (typeof tinyMCE !== 'undefined') {","            tinyMCE.triggerSave();","        }","        this.save_transaction = Y.io(this.AUTOSAVE_HANDLER, {","            method:  'POST',","            form:    {id: this.form},","            on:      {complete: this.save_done},","            context: this","        });","    },","","    save_done: function() {","        this.save_transaction = null;","","        if (this.dirty) {","            this.start_save_timer();","        }","    },","","    is_time_nearly_over: function() {","        return M.mod_quiz.timer && M.mod_quiz.timer.endtime &&","                (new Date().getTime() + 2*this.delay) > M.mod_quiz.timer.endtime;","    },","","    stop_autosaving: function() {","        this.cancel_delay();","        this.delay_timer = true;","        if (this.save_transaction) {","            this.save_transaction.abort();","        }","    }","};","","","}, '@VERSION@', {\"requires\": [\"base\", \"node\", \"event\", \"event-valuechange\", \"node-event-delegate\", \"io-form\"]});","","}());"]};
}
var __cov_iC_VZ29aiJUCN0Qt3IwGvA = __coverage__['mod/quiz/yui/build/moodle-mod_quiz-autosave/moodle-mod_quiz-autosave.js'];
__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['1']++;YUI.add('moodle-mod_quiz-autosave',function(Y,NAME){__cov_iC_VZ29aiJUCN0Qt3IwGvA.f['1']++;__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['2']++;M.mod_quiz=(__cov_iC_VZ29aiJUCN0Qt3IwGvA.b['1'][0]++,M.mod_quiz)||(__cov_iC_VZ29aiJUCN0Qt3IwGvA.b['1'][1]++,{});__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['3']++;M.mod_quiz.autosave={TINYMCE_DETECTION_DELAY:500,TINYMCE_DETECTION_REPEATS:20,WATCH_HIDDEN_DELAY:1000,SELECTORS:{QUIZ_FORM:'#responseform',VALUE_CHANGE_ELEMENTS:'input, textarea',CHANGE_ELEMENTS:'input, select',HIDDEN_INPUTS:'input[type=hidden]'},AUTOSAVE_HANDLER:M.cfg.wwwroot+'/mod/quiz/autosave.ajax.php',delay:120000,form:null,dirty:false,delay_timer:null,save_transaction:null,editor_change_handler:null,hidden_field_values:{},init:function(delay){__cov_iC_VZ29aiJUCN0Qt3IwGvA.f['2']++;__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['4']++;this.form=Y.one(this.SELECTORS.QUIZ_FORM);__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['5']++;if(!this.form){__cov_iC_VZ29aiJUCN0Qt3IwGvA.b['2'][0]++;__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['6']++;return;}else{__cov_iC_VZ29aiJUCN0Qt3IwGvA.b['2'][1]++;}__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['7']++;this.delay=delay*1000;__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['8']++;this.form.delegate('valuechange',this.value_changed,this.SELECTORS.VALUE_CHANGE_ELEMENTS,this);__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['9']++;this.form.delegate('change',this.value_changed,this.SELECTORS.CHANGE_ELEMENTS,this);__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['10']++;this.form.on('submit',this.stop_autosaving,this);__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['11']++;this.init_tinymce(this.TINYMCE_DETECTION_REPEATS);__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['12']++;this.save_hidden_field_values();__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['13']++;this.watch_hidden_fields();},save_hidden_field_values:function(){__cov_iC_VZ29aiJUCN0Qt3IwGvA.f['3']++;__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['14']++;this.form.all(this.SELECTORS.HIDDEN_INPUTS).each(function(hidden){__cov_iC_VZ29aiJUCN0Qt3IwGvA.f['4']++;__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['15']++;var name=hidden.get('name');__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['16']++;if(!name){__cov_iC_VZ29aiJUCN0Qt3IwGvA.b['3'][0]++;__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['17']++;return;}else{__cov_iC_VZ29aiJUCN0Qt3IwGvA.b['3'][1]++;}__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['18']++;this.hidden_field_values[name]=hidden.get('value');},this);},watch_hidden_fields:function(){__cov_iC_VZ29aiJUCN0Qt3IwGvA.f['5']++;__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['19']++;this.detect_hidden_field_changes();__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['20']++;Y.later(this.WATCH_HIDDEN_DELAY,this,this.watch_hidden_fields);},detect_hidden_field_changes:function(){__cov_iC_VZ29aiJUCN0Qt3IwGvA.f['6']++;__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['21']++;this.form.all(this.SELECTORS.HIDDEN_INPUTS).each(function(hidden){__cov_iC_VZ29aiJUCN0Qt3IwGvA.f['7']++;__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['22']++;var name=hidden.get('name'),value=hidden.get('value');__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['23']++;if(!name){__cov_iC_VZ29aiJUCN0Qt3IwGvA.b['4'][0]++;__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['24']++;return;}else{__cov_iC_VZ29aiJUCN0Qt3IwGvA.b['4'][1]++;}__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['25']++;if((__cov_iC_VZ29aiJUCN0Qt3IwGvA.b['6'][0]++,!(name in this.hidden_field_values))||(__cov_iC_VZ29aiJUCN0Qt3IwGvA.b['6'][1]++,value!==this.hidden_field_values[name])){__cov_iC_VZ29aiJUCN0Qt3IwGvA.b['5'][0]++;__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['26']++;this.hidden_field_values[name]=value;__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['27']++;this.value_changed({target:hidden});}else{__cov_iC_VZ29aiJUCN0Qt3IwGvA.b['5'][1]++;}},this);},init_tinymce:function(repeatcount){__cov_iC_VZ29aiJUCN0Qt3IwGvA.f['8']++;__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['28']++;if(typeof tinyMCE==='undefined'){__cov_iC_VZ29aiJUCN0Qt3IwGvA.b['7'][0]++;__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['29']++;if(repeatcount>0){__cov_iC_VZ29aiJUCN0Qt3IwGvA.b['8'][0]++;__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['30']++;Y.later(this.TINYMCE_DETECTION_DELAY,this,this.init_tinymce,[repeatcount-1]);}else{__cov_iC_VZ29aiJUCN0Qt3IwGvA.b['8'][1]++;}__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['31']++;return;}else{__cov_iC_VZ29aiJUCN0Qt3IwGvA.b['7'][1]++;}__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['32']++;this.editor_change_handler=Y.bind(this.editor_changed,this);__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['33']++;tinyMCE.onAddEditor.add(Y.bind(this.init_tinymce_editor,this));},init_tinymce_editor:function(notused,editor){__cov_iC_VZ29aiJUCN0Qt3IwGvA.f['9']++;__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['34']++;editor.onChange.add(this.editor_change_handler);__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['35']++;editor.onRedo.add(this.editor_change_handler);__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['36']++;editor.onUndo.add(this.editor_change_handler);__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['37']++;editor.onKeyDown.add(this.editor_change_handler);},value_changed:function(e){__cov_iC_VZ29aiJUCN0Qt3IwGvA.f['10']++;__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['38']++;if((__cov_iC_VZ29aiJUCN0Qt3IwGvA.b['10'][0]++,e.target.get('name')==='thispage')||(__cov_iC_VZ29aiJUCN0Qt3IwGvA.b['10'][1]++,e.target.get('name')==='scrollpos')||(__cov_iC_VZ29aiJUCN0Qt3IwGvA.b['10'][2]++,e.target.get('name').match(/_:flagged$/))){__cov_iC_VZ29aiJUCN0Qt3IwGvA.b['9'][0]++;__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['39']++;return;}else{__cov_iC_VZ29aiJUCN0Qt3IwGvA.b['9'][1]++;}__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['40']++;this.start_save_timer_if_necessary();},editor_changed:function(editor){__cov_iC_VZ29aiJUCN0Qt3IwGvA.f['11']++;__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['41']++;this.start_save_timer_if_necessary();},start_save_timer_if_necessary:function(){__cov_iC_VZ29aiJUCN0Qt3IwGvA.f['12']++;__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['42']++;this.dirty=true;__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['43']++;if((__cov_iC_VZ29aiJUCN0Qt3IwGvA.b['12'][0]++,this.delay_timer)||(__cov_iC_VZ29aiJUCN0Qt3IwGvA.b['12'][1]++,this.save_transaction)){__cov_iC_VZ29aiJUCN0Qt3IwGvA.b['11'][0]++;__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['44']++;return;}else{__cov_iC_VZ29aiJUCN0Qt3IwGvA.b['11'][1]++;}__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['45']++;this.start_save_timer();},start_save_timer:function(){__cov_iC_VZ29aiJUCN0Qt3IwGvA.f['13']++;__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['46']++;this.cancel_delay();__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['47']++;this.delay_timer=Y.later(this.delay,this,this.save_changes);},cancel_delay:function(){__cov_iC_VZ29aiJUCN0Qt3IwGvA.f['14']++;__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['48']++;if((__cov_iC_VZ29aiJUCN0Qt3IwGvA.b['14'][0]++,this.delay_timer)&&(__cov_iC_VZ29aiJUCN0Qt3IwGvA.b['14'][1]++,this.delay_timer!==true)){__cov_iC_VZ29aiJUCN0Qt3IwGvA.b['13'][0]++;__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['49']++;this.delay_timer.cancel();}else{__cov_iC_VZ29aiJUCN0Qt3IwGvA.b['13'][1]++;}__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['50']++;this.delay_timer=null;},save_changes:function(){__cov_iC_VZ29aiJUCN0Qt3IwGvA.f['15']++;__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['51']++;this.cancel_delay();__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['52']++;this.dirty=false;__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['53']++;if(this.is_time_nearly_over()){__cov_iC_VZ29aiJUCN0Qt3IwGvA.b['15'][0]++;__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['54']++;this.stop_autosaving();__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['55']++;return;}else{__cov_iC_VZ29aiJUCN0Qt3IwGvA.b['15'][1]++;}__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['56']++;if(typeof tinyMCE!=='undefined'){__cov_iC_VZ29aiJUCN0Qt3IwGvA.b['16'][0]++;__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['57']++;tinyMCE.triggerSave();}else{__cov_iC_VZ29aiJUCN0Qt3IwGvA.b['16'][1]++;}__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['58']++;this.save_transaction=Y.io(this.AUTOSAVE_HANDLER,{method:'POST',form:{id:this.form},on:{complete:this.save_done},context:this});},save_done:function(){__cov_iC_VZ29aiJUCN0Qt3IwGvA.f['16']++;__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['59']++;this.save_transaction=null;__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['60']++;if(this.dirty){__cov_iC_VZ29aiJUCN0Qt3IwGvA.b['17'][0]++;__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['61']++;this.start_save_timer();}else{__cov_iC_VZ29aiJUCN0Qt3IwGvA.b['17'][1]++;}},is_time_nearly_over:function(){__cov_iC_VZ29aiJUCN0Qt3IwGvA.f['17']++;__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['62']++;return(__cov_iC_VZ29aiJUCN0Qt3IwGvA.b['18'][0]++,M.mod_quiz.timer)&&(__cov_iC_VZ29aiJUCN0Qt3IwGvA.b['18'][1]++,M.mod_quiz.timer.endtime)&&(__cov_iC_VZ29aiJUCN0Qt3IwGvA.b['18'][2]++,new Date().getTime()+2*this.delay>M.mod_quiz.timer.endtime);},stop_autosaving:function(){__cov_iC_VZ29aiJUCN0Qt3IwGvA.f['18']++;__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['63']++;this.cancel_delay();__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['64']++;this.delay_timer=true;__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['65']++;if(this.save_transaction){__cov_iC_VZ29aiJUCN0Qt3IwGvA.b['19'][0]++;__cov_iC_VZ29aiJUCN0Qt3IwGvA.s['66']++;this.save_transaction.abort();}else{__cov_iC_VZ29aiJUCN0Qt3IwGvA.b['19'][1]++;}}};},'@VERSION@',{'requires':['base','node','event','event-valuechange','node-event-delegate','io-form']});
