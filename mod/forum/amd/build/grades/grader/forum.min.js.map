{"version":3,"sources":["../../../src/grades/grader/forum.js"],"names":["rootNodeId","registerEventListeners","document","querySelector","getUserListFetcher","cmid","Repository","getUserList","getContentFetcher","userid","getDiscussionByUserID","then","context","Templates","render","html","js","Grader","UnifiedGrading","UnifiedGradingRenderModuleContent","catch","Notification","exception","launchForumGrader","rootNode","launch","dataset","initialUserId","userListFetcher","userContentfetcher","addEventListener","e","target","matches","Selectors","grader","forum","Launch"],"mappings":"+OAgDe,SAASA,CAAT,CAAqB,CAChCC,CAAsB,CAACC,QAAQ,CAACC,aAAT,CAAuBH,CAAvB,CAAD,CACzB,C,CAlDD,OACA,OAEA,OACA,O,sDAEMI,CAAAA,CAAkB,CAAG,SAACC,CAAD,CAAU,CACjC,MAAO,WAAM,CACT,MAAOC,WAAWC,WAAX,CAAuBF,CAAvB,CACV,CACJ,C,CAEKG,CAAiB,CAAG,SAACH,CAAD,CAAU,CAChC,MAAO,UAACI,CAAD,CAAY,CACfH,UAAWI,qBAAX,CAAiCD,CAAjC,CAAyCJ,CAAzC,EACCM,IADD,CACM,SAASC,CAAT,CAAkB,CACpB,MAAOC,WAAUC,MAAV,CAAiB,kCAAjB,CAAqDF,CAArD,CACV,CAHD,EAICD,IAJD,CAIM,SAASI,CAAT,CAAeC,CAAf,CAAmB,CAErBC,UAAOC,cAAP,GACA,MAAOD,WAAOE,iCAAP,CAAyCJ,CAAzC,CAA+CC,CAA/C,CACV,CARD,EASCI,KATD,CASOC,YAAY,CAACC,SATpB,CAUH,CACJ,C,CAEKC,CAAiB,CAAG,SAACC,CAAD,CAAc,CACpCP,UAAOQ,MAAP,CAAc,CACVpB,IAAI,CAAEmB,CAAQ,CAACE,OAAT,CAAiBrB,IADb,CAEVsB,aAAa,CAAEH,CAAQ,CAACE,OAAT,CAAiBC,aAAjB,EAAkC,IAFvC,CAGVC,eAAe,CAAExB,CAAkB,CAACoB,CAAQ,CAACE,OAAT,CAAiBrB,IAAlB,CAHzB,CAIVwB,kBAAkB,CAAErB,CAAiB,CAACgB,CAAQ,CAACE,OAAT,CAAiBrB,IAAlB,CAJ3B,CAAd,CAMH,C,CAEKJ,CAAsB,CAAG,SAACuB,CAAD,CAAc,CAEzCtB,QAAQ,CAAC4B,gBAAT,CAA0B,OAA1B,CAAmC,SAACC,CAAD,CAAO,CACtC,GAAIA,CAAC,CAACC,MAAF,CAASC,OAAT,CAAiBC,UAAUC,MAAV,CAAiBC,KAAjB,CAAuBC,MAAxC,CAAJ,CAAqD,CACjDd,CAAiB,CAACC,CAAD,CACpB,CACJ,CAJD,CAKH,C","sourcesContent":["import Selectors from './selectors.js';\nimport Templates from 'core/templates';\n\nimport Grader from 'mod_forum/grades/local/grader/index';\nimport Repository from 'mod_forum/repository';\n\nconst getUserListFetcher = (cmid) => {\n    return () => {\n        return Repository.getUserList(cmid);\n    };\n};\n\nconst getContentFetcher = (cmid) => {\n    return (userid) => {\n        Repository.getDiscussionByUserID(userid, cmid)\n        .then(function(context) {\n            return Templates.render('mod_forum/forum_discussion_posts', context);\n        })\n        .then(function(html, js) {\n            // When this whole chain is moved to plugin then we will call the unified grader here passing html & js\n            Grader.UnifiedGrading();\n            return Grader.UnifiedGradingRenderModuleContent(html, js);\n        })\n        .catch(Notification.exception);\n    };\n};\n\nconst launchForumGrader = (rootNode) => {\n    Grader.launch({\n        cmid: rootNode.dataset.cmid,\n        initialUserId: rootNode.dataset.initialUserId || null,\n        userListFetcher: getUserListFetcher(rootNode.dataset.cmid),\n        userContentfetcher: getContentFetcher(rootNode.dataset.cmid),\n    });\n};\n\nconst registerEventListeners = (rootNode) => {\n    // Note: We listen to the entire body here because you can launch it from anywhere on the page.\n    document.addEventListener('click', (e) => {\n        if (e.target.matches(Selectors.grader.forum.Launch)) {\n            launchForumGrader(rootNode);\n        }\n    });\n};\n\n/**\n * @param {string} rootNodeId The root node\n */\nexport default function(rootNodeId) {\n    registerEventListeners(document.querySelector(rootNodeId));\n}\n"],"file":"forum.min.js"}