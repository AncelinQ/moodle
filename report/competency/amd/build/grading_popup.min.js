define ("report_competency/grading_popup",["jquery","core/notification","core/str","core/ajax","core/log","core/templates","tool_lp/dialogue","core/pending"],function(a,b,c,d,f,g,h,i){var j=function(b,c){this._regionSelector=b;this._userCompetencySelector=c;a(this._regionSelector).on("click",this._userCompetencySelector,this._handleClick.bind(this))};j.prototype._handleClick=function(c){var e=new i("report_competency/grading_popup:_handleClick"),g=a(c.target).closest(this._userCompetencySelector),h=a(g).data("competencyid"),j=a(g).data("courseid"),k=a(g).data("userid");f.debug("Clicked on cell: competencyId="+h+", courseId="+j+", userId="+k);var l=d.call([{methodname:"tool_lp_data_for_user_competency_summary_in_course",args:{userid:k,competencyid:h,courseid:j}},{methodname:"core_competency_user_competency_viewed_in_course",args:{userid:k,competencyid:h,courseid:j}}]);a.when(l[0],l[1]).then(this._contextLoaded.bind(this)).always(e.resolve).catch(b.exception)};j.prototype._contextLoaded=function(d){var e=new i("report_competency/grading_popup:_contextLoaded");d.displayuser=!0;a.when(g.render("tool_lp/user_competency_summary_in_course",d),c.get_string("usercompetencysummary","report_competency")).then(function(a,b){return new h(b,a[0],g.runTemplateJS.bind(g,a[1]),this._refresh.bind(this),!0)}.bind(this)).always(e.resolve).catch(b.exception)};j.prototype._refresh=function(){var c=new i("report_competency/grading_popup:_refresh"),e=a(this._regionSelector),f=e.data("courseid"),g=e.data("moduleid"),h=e.data("userid");if(""===g){g=0}d.call([{methodname:"report_competency_data_for_report",args:{courseid:f,userid:h,moduleid:g}}])[0].then(this._pageContextLoaded.bind(this)).always(c.resolve).catch(b.exception)};j.prototype._pageContextLoaded=function(a){var c=new i("report_competency/grading_popup:_pageContextLoaded");g.render("report_competency/report",a).then(function(a,b){g.replaceNode(this._regionSelector,a,b)}.bind(this)).always(c.resolve).catch(b.exception)};j.prototype._regionSelector=null;j.prototype._userCompetencySelector=null;return j});
//# sourceMappingURL=grading_popup.min.js.map
