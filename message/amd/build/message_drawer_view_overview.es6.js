define("core_message/message_drawer_view_overview",["jquery","core/key_codes","core/pubsub","core/str","core_message/message_drawer_router","core_message/message_drawer_routes","core_message/message_drawer_events","core_message/message_drawer_view_overview_section","core_message/message_repository"],function(a,b,c,d,e,f,g,h,i){var j={CONTACT_REQUEST_COUNT:"[data-region=\"contact-request-count\"]",FAVOURITES:"[data-region=\"view-overview-favourites\"]",GROUP_MESSAGES:"[data-region=\"view-overview-group-messages\"]",MESSAGES:"[data-region=\"view-overview-messages\"]",SEARCH_INPUT:"[data-region=\"view-overview-search-input\"]",SECTION_TOGGLE_BUTTON:"[data-toggle]"},k={PRIVATE:1,PUBLIC:2,FAVOURITE:null},l=null,m=function(a){if(null===l){l=i.getAllConversationCounts(a)}return l},n=function(a,b){return b===k.FAVOURITE?a.favourites:a.types[b]},o=function(a){var b=a.some(function(a){var b=a[0];return h.isVisible(b)});if(b){return}a.sort(function(c,a){var b=c[1],d=c[2],e=a[1],f=a[2];if(0<d&&0==f){return-1}else if(0==d&&0<f){return 1}else if(0<b&&0==e){return-1}else if(0==b&&0<e){return 1}else{return 0}});var c=a[0][0],d=c.find(j.SECTION_TOGGLE_BUTTON);d.click()},p=function(a){return a.find(j.SEARCH_INPUT)},q=function(a){return a.attr("data-user-id")},r=function(a){return function(){var b=a.find(j.CONTACT_REQUEST_COUNT),c=parseInt(b.text(),10);c=isNaN(c)?0:c-1;if(0>=c){b.addClass("hidden")}else{b.text(c)}}},s=function(a){var d=p(a),h=[b.tab,b.shift,b.ctrl,b.alt];d.on("click",function(){e.go(f.VIEW_SEARCH)});d.on("keydown",function(a){if(0>h.indexOf(a.keyCode)&&"Meta"!=a.key){e.go(f.VIEW_SEARCH)}});c.subscribe(g.CONTACT_REQUEST_ACCEPTED,r(a));c.subscribe(g.CONTACT_REQUEST_DECLINED,r(a))};return{show:function f(a,b){if(!a.attr("data-init")){s(a);a.attr("data-init",!0)}p(a).val("");var c=q(b),d=m(c),e=[[b.find(j.FAVOURITES),k.FAVOURITE,!0],[b.find(j.GROUP_MESSAGES),k.PUBLIC,!1],[b.find(j.MESSAGES),k.PRIVATE,!1]];e.forEach(function(a){var b=a[0],c=a[1],e=a[2],f=d.then(function(a){return n(a.total,c)}),g=d.then(function(a){return n(a.unread,c)});h.show(b,c,e,f,g)});return d.then(function(a){var b=e.map(function(b){var c=b[0],d=b[1],e=n(a.total,d),f=n(a.unread,d);return[c,e,f]});return o(b)})},description:function a(){return d.get_string("messagedrawerviewoverview","core_message")}}});
//# sourceMappingURL=message_drawer_view_overview.es6.js.map
