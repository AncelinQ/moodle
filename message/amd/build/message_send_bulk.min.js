define ("core_message/message_send_bulk",["exports","jquery","core/str","core/modal_factory","core/templates","core/modal_events","core/ajax","core/notification"],function(a,b,c,d,e,f,g,h){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.sendMessage=a.showModal=void 0;b=i(b);c=function(a){if(a&&a.__esModule){return a}else{var b={};if(null!=a){for(var c in a){if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};if(d.get||d.set){Object.defineProperty(b,c,d)}else{b[c]=a[c]}}}}b.default=a;return b}}(c);d=i(d);e=i(e);f=i(f);g=i(g);h=i(h);function i(a){return a&&a.__esModule?a:{default:a}}var j=function(a){var g=1<arguments.length&&arguments[1]!==void 0?arguments[1]:null;if(0==a.length){return b.default.Deferred().resolve().promise()}var h=null;if(1==a.length){h=c.get_string("sendbulkmessagesingle","core_message")}else{h=c.get_string("sendbulkmessage","core_message",a.length)}return b.default.when(d.default.create({type:d.default.types.SAVE_CANCEL,body:e.default.render("core_user/send_bulk_message",{})}),h).then(function(b,c){b.setTitle(c);b.setSaveButtonText(c);b.getRoot().on(f.default.hidden,function(){if(g){g()}b.getRoot().remove()});b.getRoot().on(f.default.save,function(){var c=b.getRoot().find("form textarea").val();k(c,a)});b.show();return b})};a.showModal=j;var k=function(a,b){var d=[],e=0;for(e=0;e<b.length;e++){d.push({touserid:b[e],text:a})}return g.default.call([{methodname:"core_message_send_instant_messages",args:{messages:d}}])[0].then(function(a){if(1==a.length){return c.get_string("sendbulkmessagesentsingle","core_message")}else{return c.get_string("sendbulkmessagesent","core_message",a.length)}}).then(function(a){h.default.addNotification({message:a,type:"success"});return!0}).catch(h.default.exception)};a.sendMessage=k});
//# sourceMappingURL=message_send_bulk.min.js.map
