define("core_message/message_drawer_router",["jquery","core/pubsub","core/str","core_message/message_drawer_events"],function(a,b,c,d){var e={},f=[],g={CAN_RECEIVE_FOCUS:"input:not([type=\"hidden\"]), a[href], button, textarea, select, [tabindex]",ROUTES_BACK:"[data-route-back]"},h=function(c){var f,h=[].slice.call(arguments,1),j=a.Deferred().resolve().promise();Object.keys(e).forEach(function(a){var b=e[a],d=a===c;if(d){f=b}b.elements.forEach(function(a){a.removeClass("previous");if(d){a.removeClass("hidden");a.attr("aria-hidden",!1)}else{a.addClass("hidden");a.attr("aria-hidden",!0)}})});if(f){if(f.onGo){j=f.onGo.apply(void 0,f.elements.concat(h));for(var k=a(document.activeElement),l=!1,m=0,n;m<f.elements.length;m++){n=f.elements[m];if(n.has(k).length){l=!0;break}}if(!l){f.elements[0].find(g.CAN_RECEIVE_FOCUS).filter(":visible").first().focus()}}}var o={route:c,params:h,renderPromise:j};b.publish(d.ROUTE_CHANGED,o);return o},i=function(){var b=a(document.activeElement),d=h.apply(null,arguments),i=!1;f=f.reduce(function(a,b){if(b.route===d.route){i=!0}if(!i){a.push(b)}return a},[]);var j=f.length?f[f.length-1]:null;if(j){var k=e[j.route];k.elements.forEach(function(a){a.addClass("previous")});j.focusElement=b;if(k.getDescription){k.getDescription.apply(null,k.elements.concat(j.params)).then(function(a){return c.get_string("backto","core_message",a)}).then(function(a){return d.renderPromise.then(function(){e[d.route].elements.forEach(function(b){b.find(g.ROUTES_BACK).attr("aria-label",a)})})}).catch(function(){})}}f.push(d);return d},j=function(){if(f.length){f.pop();var a=f.pop();if(a){i.apply(void 0,[a.route].concat(a.params));window.setTimeout(function(){a.focusElement.focus()},50)}}};return{add:function f(a,b,c,d){e[a]={elements:b,onGo:c,getDescription:d}},go:i,back:j}});
//# sourceMappingURL=message_drawer_router.min.js.map
