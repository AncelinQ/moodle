define("core_message/message_drawer_view_conversation_state_manager",["jquery"],function(a){var b=function(b){var c=a.extend({},b);c.messages=b.messages.map(function(b){return a.extend({},b)});c.members=Object.keys(b.members).reduce(function(c,d){c[d]=a.extend({},b.members[d]);c[d].contactrequests=b.members[d].contactrequests.map(function(b){return a.extend({},b)});return c},{});return c},c=function(a,b,c){return a.map(function(a){var d=a.useridfrom==b;return{id:parseInt(a.id,10),isRead:a.isread,fromLoggedInUser:d,userFrom:c[a.useridfrom],text:a.text,timeCreated:parseInt(a.timecreated,10)}})},d=function(a){return a.map(function(a){return{id:a.id,fullname:a.fullname,profileurl:a.profileurl,profileimageurl:a.profileimageurl,profileimageurlsmall:a.profileimageurlsmall,isonline:a.isonline,showonlinestatus:a.showonlinestatus,isblocked:a.isblocked,iscontact:a.iscontact,isdeleted:a.isdeleted,canmessage:a.canmessage,requirescontact:a.requirescontact,contactrequests:a.contactrequests||[]}})};return{buildInitialState:function d(a,b,c){return{midnight:a,loggedInUserId:b,id:c,name:null,subname:null,type:null,totalMemberCount:null,imageUrl:null,isFavourite:null,members:{},messages:[],hasTriedToLoadMessages:!1,loadingMessages:!0,sendingMessage:!1,loadingMembers:!0,loadingConfirmAction:!1,pendingBlockUserIds:[],pendingUnblockUserIds:[],pendingRemoveContactIds:[],pendingAddContactIds:[],pendingDeleteMessageIds:[],pendingDeleteConversation:!1,selectedMessageIds:[]}},addMessages:function h(a,d){var e=b(a),f=c(d,a.loggedInUserId,a.members),g=a.messages.concat(f);g.sort(function(c,a){if(c.timeCreated<a.timeCreated){return-1}else if(c.timeCreated>a.timeCreated){return 1}else if(c.id<a.id){return-1}else if(c.id>a.id){return 1}else{return 0}});e.messages=g.filter(function(a,b,c){return!b||a.id!==c[b-1].id});return e},removeMessages:function f(a,c){var d=b(a),e=c.map(function(a){return a.id});d.messages=d.messages.filter(function(a){return 0>e.indexOf(a.id)});return d},removeMessagesById:function e(a,c){var d=b(a);d.messages=d.messages.filter(function(a){return 0>c.indexOf(a.id)});return d},addMembers:function g(a,c){var e=b(a),f=d(c);f.forEach(function(a){e.members[a.id]=a});return e},removeMembers:function e(a,c){var d=b(a);c.forEach(function(a){delete d.members[a.id]});return d},setLoadingMessages:function e(a,c){var d=b(a);d.loadingMessages=c;if(a.loadingMessages&&!c){d.hasTriedToLoadMessages=!0}return d},setSendingMessage:function e(a,c){var d=b(a);d.sendingMessage=c;return d},setLoadingMembers:function e(a,c){var d=b(a);d.loadingMembers=c;return d},setId:function e(a,c){var d=b(a);d.id=c;return d},setName:function e(a,c){var d=b(a);d.name=c;return d},setSubname:function e(a,c){var d=b(a);d.subname=c;return d},setType:function e(a,c){var d=b(a);d.type=c;return d},setIsFavourite:function e(a,c){var d=b(a);d.isFavourite=c;return d},setTotalMemberCount:function e(a,c){var d=b(a);d.totalMemberCount=c;return d},setImageUrl:function e(a,c){var d=b(a);d.imageUrl=c;return d},setLoadingConfirmAction:function e(a,c){var d=b(a);d.loadingConfirmAction=c;return d},setPendingDeleteConversation:function e(a,c){var d=b(a);d.pendingDeleteConversation=c;return d},addPendingBlockUsersById:function e(a,c){var d=b(a);c.forEach(function(a){d.pendingBlockUserIds.push(a)});return d},addPendingRemoveContactsById:function e(a,c){var d=b(a);c.forEach(function(a){d.pendingRemoveContactIds.push(a)});return d},addPendingUnblockUsersById:function e(a,c){var d=b(a);c.forEach(function(a){d.pendingUnblockUserIds.push(a)});return d},addPendingAddContactsById:function e(a,c){var d=b(a);c.forEach(function(a){d.pendingAddContactIds.push(a)});return d},addPendingDeleteMessagesById:function e(a,c){var d=b(a);c.forEach(function(a){d.pendingDeleteMessageIds.push(a)});return d},removePendingBlockUsersById:function e(a,c){var d=b(a);d.pendingBlockUserIds=d.pendingBlockUserIds.filter(function(a){return 0>c.indexOf(a)});return d},removePendingRemoveContactsById:function e(a,c){var d=b(a);d.pendingRemoveContactIds=d.pendingRemoveContactIds.filter(function(a){return 0>c.indexOf(a)});return d},removePendingUnblockUsersById:function e(a,c){var d=b(a);d.pendingUnblockUserIds=d.pendingUnblockUserIds.filter(function(a){return 0>c.indexOf(a)});return d},removePendingAddContactsById:function e(a,c){var d=b(a);d.pendingAddContactIds=d.pendingAddContactIds.filter(function(a){return 0>c.indexOf(a)});return d},removePendingDeleteMessagesById:function e(a,c){var d=b(a);d.pendingDeleteMessageIds=d.pendingDeleteMessageIds.filter(function(a){return 0>c.indexOf(a)});return d},addSelectedMessagesById:function e(a,c){var d=b(a);d.selectedMessageIds=d.selectedMessageIds.concat(c);return d},removeSelectedMessagesById:function e(a,c){var d=b(a);d.selectedMessageIds=d.selectedMessageIds.filter(function(a){return 0>c.indexOf(a)});return d},markMessagesAsRead:function f(a,c){var d=b(a),e=c.map(function(a){return a.id});d.messages=d.messages.map(function(a){if(0<=e.indexOf(a.id)){a.isRead=!0}return a});return d},addContactRequests:function e(a,c){var d=b(a);c.forEach(function(a){var b=a.userid,c=a.requesteduserid;d.members[b].contactrequests.push(a);d.members[c].contactrequests.push(a)});return d},removeContactRequests:function e(a,c){var d=b(a);c.forEach(function(a){var b=a.userid,c=a.requesteduserid;d.members[b].contactrequests=d.members[b].contactrequests.filter(function(a){return a.userid!=b});d.members[c].contactrequests=d.members[c].contactrequests.filter(function(a){return a.requesteduserid!=c})});return d}}});
//# sourceMappingURL=message_drawer_view_conversation_state_manager.min.js.map
