YUI.add("moodle-course-categoryexpander",function(e,t){var n={ANIMATOR:"div.animator",COURSES:".courses",LISTENLINK:".category_name",PARENTWITHCHILDREN:"div.category",SUBCATEGORIES:".subcategories"},r={ANIMATOR:"animator",COURSES:"courses",LOADED:"loaded",NOTLOADED:"notloaded",SECTIONCOLLAPSED:"collapsed",SUBCATEGORIES:"subcategories",HASCHILDREN:"with_children"},i=4;M.course=M.course||{},M.course.categoryexpander=M.course.categoryexpander||{init:function(){e.one(e.config.doc).delegate("click",this.toggle_expansion,n.LISTENLINK,this),this.init=function(){}},toggle_expansion:function(t){var s,o,u,a;t.preventDefault(),s=t.target.ancestor(n.PARENTWITHCHILDREN,!0);if(!s.hasClass(r.HASCHILDREN))return;if(s.hasClass(r.NOTLOADED)){o=s.getData("categoryid"),u=s.getData("depth");if(typeof o=="undefined"||typeof u=="undefined")return;e.io(M.cfg.wwwroot+"/course/category.ajax.php",{method:"POST",context:this,on:{complete:this.handle_category_results},data:{type:i,categoryid:o,depth:u},arguments:{categorynode:s}})}else a=s.one(n.ANIMATOR),a||this.add_animator(s),s.toggleClass(r.SECTIONCOLLAPSED)},handle_category_results:function(t,i,s){var o,u,a,f,l;try{l=e.JSON.parse(i.responseText);if(l.error)return new M.core.ajaxException(l)}catch(c){return new M.core.exception(c)}a=e.Node.create(l),s.categorynode.addClass(r.LOADED).removeClass(r.NOTLOADED),o=a.one(n.SUBCATEGORIES),u=a.one(n.COURSES),f=this.add_animator([o,u]),s.categorynode.appendChild(f)},add_animator:function(t){var n=e.Node.create("<div>").addClass(r.ANIMATOR);return n.fx=new e.Anim({node:n,from:{height:0,opacity:0},to:{height:"100%",opacity:1}}),t.get("children").each(function(e){n.appendChild(e)}),t.appendChild(n),t}}},"@VERSION@",{requires:["node","io-base","json-parse","moodle-core-notification","anim"]});
